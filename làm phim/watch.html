<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Xem phim</title>
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #0f172a, #020617);
            color: white;
        }

        .container {
            max-width: 1000px;
            margin: 30px auto;
            padding: 0 15px;
        }

        h1 {
            margin-bottom: 10px;
        }

        .episode {
            color: #38bdf8;
            margin-bottom: 15px;
        }

        .video-box {
            position: relative;
            padding-top: 56.25%; /* 16:9 */
            background: black;
            border-radius: 12px;
            overflow: hidden;
        }

        .video-box iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
        }

        .back {
            display: inline-block;
            margin-top: 20px;
            color: #facc15;
            text-decoration: none;
            font-weight: bold;
        }

        .back:hover {
            text-decoration: underline;
        }
        .episode-title {
    margin: 20px 0 10px;
    color: orange;
    font-weight: bold;
}

.episode-list {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
}

.episode-list button {
    width: 36px;
    height: 36px;
    border: none;
    border-radius: 4px;
    background: #2b2b2b;
    color: white;
    cursor: pointer;
}

.episode-list button.active,
.episode-list button:hover {
    background: #f59e0b;
    color: black;
}

    </style>
</head>
<body>

<div class="container">
    <h1 id="movieTitle"></h1>
    <div class="episode" id="movieEp"></div>

    <div class="video-box">
        <iframe id="ytPlayer"
            src=""
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
            allowfullscreen>
        </iframe>
    </div>
    <div id="episodeBox"></div>


    <a href="index.html" class="back">← Quay lại</a>
</div>

<script>
    const isLogin = localStorage.getItem("isLogin");

if (!isLogin) {
    alert("⚠️ Bạn cần đăng nhập để xem phim!");
    window.location.href = "index.html";
}
    const movie = JSON.parse(localStorage.getItem("currentMovie"));
const player = document.getElementById("ytPlayer");
const episodeBox = document.getElementById("episodeBox");

if (!movie) {
    document.body.innerHTML = "<h2>Không có dữ liệu phim</h2>";
} else {
    document.getElementById("movieTitle").innerText = movie.name;

    // PHIM BỘ
    if (movie.type === "phimbo" && movie.episodes) {
        player.src = movie.episodes[0].youtube;

        episodeBox.innerHTML = `
            <div class="episode-title">${movie.episodes[0].label} #1:</div>
            <div class="episode-list">
                ${movie.episodes.map((e, i) => `
                    <button class="${i === 0 ? "active" : ""}"
                        onclick="changeEpisode(${i})">
                        ${e.ep}
                    </button>
                `).join("")}
</div>
        `;

        window.changeEpisode = function (index) {
            player.src = movie.episodes[index].youtube;

            document.querySelectorAll(".episode-list button")
                .forEach((b, i) => {
                    b.classList.toggle("active", i === index);
                });
        };
    }
    // PHIM LẺ
    else {
        player.src = movie.youtube;
    }
}

</script>

</body>
</html>